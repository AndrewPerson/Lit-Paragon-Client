<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="shortcut icon" type="image/webp" href="icons/128.webp">

    <meta property="og:image" content="https://web-paragon.web.app/icons/512.webp">
    <meta property="og:image:alt" content="Paragon is the next generation of Student Portal Alternatives at SBHS">
    <meta property="og:site_name" content="Paragon">
    <meta property="og:type" content="object">
    <meta property="og:title" content="Paragon">
    <meta property="og:url" content="https://web-paragon.web.app/">
    <meta property="og:description" content="Paragon is the next generation of Student Portal Alternatives at SBHS, with offline functionality, blazingly fast load times and student ID barcode replication.">
    
    <title>Paragon</title>
    
    <base href="/">

    <link href="assets/app-44cc30c0.css" rel="stylesheet">
    <link href="assets/navbar-3b4c4cc2.css" rel="stylesheet">
    <link href="assets/barcode-988e5a57.css" rel="stylesheet">

    <link href="assets/manifest.json" rel="manifest">

    <script src="assets/jsbarcode-cf8d2644.js"></script>

    
</head>

<body>
    <script src="assets/main-a52dfe53.js"></script>

    <nav-bar></nav-bar>

    <main id="main">
        <p id="info" style="display: none;">Tap in two places to form the barcode</p>
        
        <div>
            <canvas style="display: none;" id="barcode"></canvas>
            <img style="display: none;" id="point1" draggable="false" src="assets/circle-6885aafd.svg">
            <img style="display: none;" id="point2" draggable="false" src="assets/circle-6885aafd.svg">
        </div>

        <button title="Edit" class="edit" onclick="RequestBarcodeSize()">
            <img draggable="false" style="width: inherit; height: inherit;" src="assets/edit-b6534a1f.svg">
        </button>

        <img draggable="false" onmouseenter="ShowDescription()" onmouseleave="HideDescription()" id="description" src="assets/info-d7ecfc10.svg">
    
        <p style="display: none;" id="descriptionContent">You can use this barcode to scan in at the school scanners instead of your student card</p>
    </main>

    <script>
        var id;
        var loadingElement;

        var point1 = document.getElementById("point1");
        var point2 = document.getElementById("point2");

        var info = document.getElementById("info");

        var barcode = document.getElementById("barcode");

        var main = document.getElementById("main");

        function ShowDescription() {
            document.getElementById("descriptionContent").style.display = "";
        }

        function HideDescription() {
            document.getElementById("descriptionContent").style.display = "none";
        }

        function GetPercentageFromPixels(x, y) {
            return {x: (x - main.offsetLeft) / main.clientWidth * 100, y: (y - main.offsetTop) / main.clientHeight * 100};
        }

        function GetPixelsFromPercentage(x, y) {
            return {x: main.clientWidth * x / 100 + main.offsetLeft, y: main.clientHeight * y / 100 + main.offsetTop};
        }

        async function RequestBarcodeSize() {
            info.style.display = "";
            barcode.style.display = "none";

            point1.style.display = "none";
            point2.style.display = "none";

            var userInput = new Promise(resolve => {
                var clicks = 0;
                main.addEventListener("pointerdown", event => {
                    clicks++;

                    if (clicks == 1) {
                        var {x, y} = GetPercentageFromPixels(event.clientX - 10, event.clientY - 10);
                        
                        point1.style.left = `${x}%`;
                        point1.style.top = `${y}%`;
                        point1.style.display = "";
                    }
                    else if (clicks == 2) {
                        var {x, y} = GetPercentageFromPixels(event.clientX - 10, event.clientY - 10);

                        point2.style.left = `${x}%`;
                        point2.style.top = `${y}%`;
                        point2.style.display = "";

                        document.removeEventListener("pointerdown", this);

                        resolve();
                    }
                });
            });

            await userInput;

            info.style.display = "none";

            barcode.style.display = "";
            UpdateBarcodeSize();
        }

        function UpdateBarcodeSize() {
            if (id) {
                var x1 = parseFloat(point1.style.left.replace("%", ""));
                var y1 = parseFloat(point1.style.top.replace("%", ""));

                var x2 = parseFloat(point2.style.left.replace("%", ""));
                var y2 = parseFloat(point2.style.top.replace("%", ""));

                var maxX;
                var minX;

                var maxY;
                var minY;

                if (x1 > x2) {
                    maxX = x1;
                    minX = x2;
                }
                else {
                    maxX = x2;
                    minX = x1;
                }

                if (y1 > y2) {
                    maxY = y1;
                    minY = y2;
                }
                else {
                    maxY = y2;
                    minY = y1;
                }

                barcode.style.top = `${minY}%`;
                barcode.style.left = `${minX}%`;

                barcode.style.width = `${maxX - minX}%`;
                barcode.style.height = `${maxY - minY}%`;

                JsBarcode(barcode, id, {
                    displayValue: false,
                    margin: 0
                });
            }
        }

        async function onUserData() {
            var userInfo = await GetResourceFromCache("userinfo");

            if (!userInfo) {
                loadingElement = document.createElement("loading-element");

                loadingElement.style = "width: 80%";

                main.appendChild(loadingElement);

                return;
            }

            if (loadingElement)
                loadingElement.remove();

            id = JSON.parse(userInfo).studentId;

            barcode.imageSmoothingEnabled = false;
            
            var {x, y} = GetPixelsFromPercentage(80, 10);
            ({x, y} = GetPercentageFromPixels(x - 10, y - 10));

            point1.style.top = `${y}%`;
            point1.style.left = `${x}%`;

            ({x, y} = GetPixelsFromPercentage(20, 30));
            ({x, y} = GetPercentageFromPixels(x - 10, y - 10));

            point2.style.top = `${y}%`;
            point2.style.left = `${x}%`;

            UpdateBarcodeSize();

            barcode.style.display = "";
            point1.style.display = "";
            point2.style.display = "";
        }
    </script>



<script type="module" src="./main-elements.js"></script></body></html>